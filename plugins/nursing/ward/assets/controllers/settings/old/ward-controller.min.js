angular.module("EmmetBlue").controller("wardController",function(e,a,t,n){var r={actionsMarkup:function(e,a,t){var n="functions.manageWard.editWard("+t.WardID+")",r="functions.manageWard.deleteWard("+t.WardID+")",d="functions.manageWard.manageSections("+t.WardID+")",o="data-option-id='"+t.WardID+"' data-option-ward-name='"+t.WardName+"' data-option-ward-desc='"+t.WardDescription+"'",i="<button class='btn btn-default' ng-click=\""+n+'" '+o+"><i class='icon-pencil5'></i> Edit</button>",s="<button class='btn btn-default' ng-click=\""+r+'" '+o+">Delete</button>",c="<div class='btn-group'>"+i+s+"</button>",s="<button class='btn btn-default' ng-click=\""+r+'" '+o+"><i class='icon-bin'></i> Delete</button>",l="<button class='btn btn-default' ng-click=\""+d+'" '+o+"><i class=''></i> Manage Sections</button>",c="<div class='btn-group'>"+i+s+l+"</button>";return c},manageWard:{newWard:function(){$("#new-ward").modal("show")},newWardCreated:function(){a.alert("Operation Succesful","New Ward Created","success","notify"),e.newWard={},e.dtInstance.reloadData(),$("#new-ward").modal("hide")},editWard:function(a){var t=$(".btn[data-option-id='"+a+"']").attr("data-option-ward-name"),n=$(".btn[data-option-id='"+a+"']").attr("data-option-ward-desc");e.temp={id:a,name:t,desc:n},$("#edit-ward").modal("show")},manageSections:function(e){var t={name:$(".btn[data-option-id='"+e+"']").attr("data-option-ward-name"),id:e};a.storage.sectionManagementData=t,$("#manage-sections").modal("show")},wardEdited:function(){a.alert("Operation Successful","Your changes have been saved successfully","success","notify"),e.tempHolder={},e.dtInstance.reloadData(),$("#edit-ward").modal("hide")},wardDeleted:function(){a.alert("Operation Successful","The selected ward has been deleted successfully","success","notify"),e.tempHolder={},delete e._id,e.dtInstance.reloadData()},deleteWard:function(t){var n="Delete Prompt",d="You are about to delete this Ward named "+$(".btn[data-option-id='"+t+"']").attr("data-option-ward-name")+". Do you want to continue? Please note that this action cannot be undone",o=!0;e._id=t;var i=function(){var t=a.serverRequest("/nursing/ward/delete?"+a.serializeParams({resourceId:e._id}),"DELETE");t.then(function(){r.manageWard.wardDeleted()},function(e){a.errorHandler(e)})},s="warning",c="Delete";a.confirm(n,d,o,i,s,c)}}};e.dtInstance={},e.temp={},e.dtOptions=t.fromFnPromise(function(){var e=a.serverRequest("/nursing/ward/view","GET");return e}).withOption("createdRow",function(t){a.compile(angular.element(t).contents())(e)}).withOption("headerCallback",function(t){e.headerCompiled||(e.headerCompiled=!0,a.compile(angular.element(t).contents())(e))}).withButtons([{text:'<i class="icon-file-plus"> </i> <u>N</u>ew  Ward',action:function(){r.manageWard.newWard()},key:{key:"n",ctrlKey:!0,altKey:!0}},{extend:"print",text:'<i class="icon-printer"></i> <u>P</u>rint this data page',key:{key:"p",ctrlKey:!0,altKey:!0}},{extend:"copy",text:'<i class="icon-copy"></i> <u>C</u>opy this data',key:{key:"c",ctrlKey:!0}}]),e.dtColumns=[n.newColumn("WardID").withTitle("Ward ID"),n.newColumn("WardName").withTitle("Ward Name"),n.newColumn("WardDescription").withTitle("Ward Description"),n.newColumn(null).withTitle("Action").notSortable().renderWith(r.actionsMarkup)],e.saveNewWard=function(){$(".loader").addClass("show");var t=e.wardRegistration;ward=a.serverRequest("/nursing/ward/new","post",t),ward.then(function(){$(".loader").removeClass("show"),r.manageWard.newWardCreated()},function(e){$(".loader").removeClass("show"),a.errorHandler(e)})},e.manageEditWard=function(e){r.manageWard.editWard(e)},e.saveEditWard=function(){var t={resourceId:e.temp.id,WardName:e.temp.name,WardDescription:e.temp.desc};$(".loader").addClass("show");var n=a.serverRequest("/nursing/ward/edit","PUT",t);n.then(function(){$(".loader").removeClass("show"),r.manageWard.wardEdited()},function(e){$(".loader").removeClass("show"),a.errorHandler(e)})},e.functions=r});