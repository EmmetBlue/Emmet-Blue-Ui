angular.module("EmmetBlue").controller("nursingManageBedsController",function(e,n){function t(){return""}function o(){e.dtInstance.reloadData()}function i(){var t=n.serverRequest("/nursing/ward/view","GET");t.then(function(n){e.wards=n},function(e){n.errorHandler(e)})}function r(t){var o=n.serverRequest("/nursing/ward-section/view?resourceId="+t,"GET");o.then(function(n){e.sections=n},function(e){n.errorHandler(e)})}e.dtInstance={},e.dtOptions=n.DT.optionsBuilder.fromFnPromise(function(){return n.serverRequest("/nursing/section-bed/view?resourceId="+e.currentSection,"GET")}).withPaginationType("full_numbers").withDisplayLength(10).withFixedHeader().withOption("createdRow",function(t){n.compile(angular.element(t).contents())(e)}).withOption("headerCallback",function(t){e.headerCompiled||(e.headerCompiled=!0,n.compile(angular.element(t).contents())(e))}).withButtons([{text:'<i class="icon-file-plus"></i> New Bed',action:function(){$("#new_bed").modal("show")}}]),e.dtColumns=[n.DT.columnBuilder.newColumn("SectionBedID").withTitle("ID"),n.DT.columnBuilder.newColumn(null).withTitle("Bed Name").renderWith(function(e){var n=e.BedName+"<span class='pull-right'>";return 1==e.BedStatus?n+="&nbsp;<span class='label label-danger'> Occupied</span>":0==e.BedStatus&&(n+="&nbsp;<span class='label label-success'> Unoccupied</span>"),n+"</span>"}),n.DT.columnBuilder.newColumn(null).withTitle("Action").renderWith(t).notSortable()],e.saveBed=function(){e.bed.section=e.currentSection;var t=n.serverRequest("/nursing/section-bed/new","POST",e.bed);t.then(function(){$("#new_bed").modal("hide"),o(),n.notify("Operation Successful","New Bed Registered Successfully","success"),e.bed={}},function(e){n.errorHandler(e)})},e.saveEditBed=function(){var t=n.serverRequest("/nursing/section-bed/edit","PUT",e.tempHolder);t.then(function(){$("#edit_bed").modal("hide"),o(),n.notify("Operation Successful","Bed updated succesfully","success"),e.tempHolder={}},function(e){n.errorHandler(e)})},e.tempHolder={},e.manage=function(t,i){switch(t){case"edit":e.tempHolder.resourceId=i,e.tempHolder.BedName=$(".btn[data-option-id='"+i+"']").attr("data-option-name"),e.tempHolder.BedDescription=$(".btn[data-option-id='"+i+"']").attr("data-option-description"),$("#edit_bed").modal("show");break;case"delete":var r="Delete Prompt",a="You are about to delete the Bed titled "+$(".btn[data-option-id='"+i+"']").attr("data-option-name")+". Do you want to continue? Please note that this action cannot be undone",u=!0,d=function(){var e=n.serverRequest("/nursing/section-bed/delete?"+n.serializeParams({resourceId:i}),"DELETE");e.then(function(){n.notify("Operation Successful","Bed has been deleted successfully","success"),o()},function(e){n.errorHandler(e)})},s="warning",c="Delete";n.confirm(r,a,u,d,s,c)}},e.$watch(function(){return e.currentWard},function(e){"undefined"!=typeof e&&r(e)}),e.$watch(function(){return e.currentSection},function(e){"undefined"!=typeof e&&o()}),i()});