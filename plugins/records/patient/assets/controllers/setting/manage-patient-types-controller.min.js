angular.module("EmmetBlue").controller("recordsPatientSettingManagePatientTypesController",function(e,t){function n(){e.dtInstance.reloadData()}var a={actionMarkups:{categoryActionMarkup:function(e){var t="editPatientType("+e.PatientTypeID+")",n="deletePatientType("+e.PatientTypeID+")",a="data-option-id='"+e.PatientTypeID+"' data-option-name='"+e.PatientTypeName+"' data-option-description='"+e.PatientTypeDescription+"'",o="<button class='btn btn-patient-type btn-default' ng-click=\""+t+'" '+a+"> Edit</button>",i="<button class='btn btn-patient-type btn-default' ng-click=\""+n+'" '+a+"> Delete</button>",r="<div class='btn-category'>"+o+i+"</button>";return r}},loadPatientTypeCategories:function(){var n=t.serverRequest("/patients/patient-type-category/view","GET");n.then(function(t){e.patientTypeCategories=t},function(e){t.errorHandler(e)})}};a.loadPatientTypeCategories(),e.loadPatientTypeCategories=a.loadPatientTypeCategories,e.dtOptions=t.DT.optionsBuilder.fromFnPromise(function(){var e=t.serverRequest("/patients/patient-type/view","GET");return e}).withPaginationType("full_numbers").withDisplayLength(10).withOption("createdRow",function(n){t.compile(angular.element(n).contents())(e)}).withOption("headerCallback",function(n){e.headerCompiled||(e.headerCompiled=!0,t.compile(angular.element(n).contents())(e))}).withButtons([{text:"New Patient Type",action:function(){e.newPatientType={},$("#new_setting_records_patient").modal("show")}},{extend:"print",text:"<u>P</u>rint this data page"},{extend:"copy",text:"<u>C</u>opy this data"}]),e.dtColumns=[t.DT.columnBuilder.newColumn("PatientTypeName").withTitle("Patient Type"),t.DT.columnBuilder.newColumn("CategoryName").withTitle("Category"),t.DT.columnBuilder.newColumn(null).withTitle("Action").renderWith(a.actionMarkups.categoryActionMarkup).notSortable()],e.dtInstance={},e.tempHolder={},e.editPatientType=function(t){e.tempHolder.PatientTypeName=$(".btn[data-option-id='"+t+"']").attr("data-option-name"),e.tempHolder.PatientTypeDescription=$(".btn[data-option-id='"+t+"']").attr("data-option-description"),e.tempHolder.resourceId=t,$("#edit_setting_records_patient").modal("show")},e.deletePatientType=function(a){var o="Delete Prompt",i='You are about to delete the patient type named "'+$(".btn[data-option-id='"+a+"']").attr("data-option-name")+'". Do you want to continue? Please note that this action cannot be undone',r=!0;e._categoryId=a;var s=function(){var a=t.serverRequest("/patients/patient-type/delete?"+t.serializeParams({resourceId:e._categoryId}),"DELETE");a.then(function(){t.alert("Operation Successful","The selected category has been deleted successfully","success","notify"),delete e._groupId,n()},function(e){t.errorHandler(e)})},l="warning",d="Delete";t.confirm(o,i,r,s,l,d)},e.saveEditPatientType=function(){var a={resourceId:e.tempHolder.resourceId,PatientTypeName:e.tempHolder.PatientTypeName,PatientTypeDescription:e.tempHolder.PatientTypeDescription,CategoryName:e.tempHolder.CategoryName};$(".loader").addClass("show");var o=t.serverRequest("/patients/patient-type/edit","PUT",a);o.then(function(){$(".loader").removeClass("show"),t.alert("Operation Successful","Your changes has been saved successfully","success","notify"),$("#edit_setting_records_patient").modal("hide"),e.tempHolder={},n()},function(e){$("loader").removeClass("show"),t.errorHandler(e)})},e.saveNewPatientType=function(){var a=e.newPatientType;console.log(a),$(".loader").addClass("show");var o=t.serverRequest("/patients/patient-type/new","POST",a);o.then(function(){$(".loader").removeClass("show"),t.alert("Operation Successful","You have successfully creaed a new category","success","notify"),$("#new_setting_records_patient").modal("hide"),e.newPatientType={},n()},function(e){$(".loader").removeClass("show"),t.errorHandler(e)})}});