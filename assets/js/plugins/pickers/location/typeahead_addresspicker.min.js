(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,o=function(t,o){function r(){this.constructor=t}for(var n in o)e.call(o,n)&&(t[n]=o[n]);return r.prototype=o.prototype,t.prototype=new r,t.__super__=o.prototype,t};!function(e){return this.AddressPickerResult=function(){function t(t,e){this.placeResult=t,this.fromReverseGeocoding=null!=e?e:!1,this.latitude=this.placeResult.geometry.location.lat(),this.longitude=this.placeResult.geometry.location.lng()}return t.prototype.addressTypes=function(){var t,e,o,r,n,s,i,a,p;for(o=[],a=this.addressComponents(),r=0,s=a.length;s>r;r++)for(t=a[r],p=t.types,n=0,i=p.length;i>n;n++)e=p[n],-1===o.indexOf(e)&&o.push(e);return o},t.prototype.addressComponents=function(){return this.placeResult.address_components||[]},t.prototype.address=function(){return this.placeResult.formatted_address},t.prototype.nameForType=function(t,e){var o,r,n,s;for(null==e&&(e=!1),s=this.addressComponents(),r=0,n=s.length;n>r;r++)if(o=s[r],-1!==o.types.indexOf(t))return e?o.short_name:o.long_name;return null},t.prototype.lat=function(){return this.latitude},t.prototype.lng=function(){return this.longitude},t.prototype.setLatLng=function(t,e){this.latitude=t,this.longitude=e},t.prototype.isAccurate=function(){return!this.placeResult.geometry.viewport},t.prototype.isReverseGeocoding=function(){return this.fromReverseGeocoding},t}(),this.AddressPicker=function(r){function n(o){null==o&&(o={}),this.markerDragged=t(this.markerDragged,this),this.updateBoundsForPlace=t(this.updateBoundsForPlace,this),this.updateMap=t(this.updateMap,this),this.options=e.extend({local:[],datumTokenizer:function(t){return Bloodhound.tokenizers.whitespace(t.num)},queryTokenizer:Bloodhound.tokenizers.whitespace,autocompleteService:{types:["geocode"]},zoomForLocation:16,reverseGeocoding:!1},o),n.__super__.constructor.call(this,this.options),this.options.map&&this.initMap(),this.placeService=new google.maps.places.PlacesService(document.createElement("div"))}return o(n,r),n.prototype.bindDefaultTypeaheadEvent=function(t){return t.bind("typeahead:selected",this.updateMap),t.bind("typeahead:cursorchanged",this.updateMap)},n.prototype.initMap=function(){var t,o,r;return(null!=(o=this.options)&&null!=(r=o.map)?r.gmap:void 0)?this.map=this.options.map.gmap:(this.mapOptions=e.extend({zoom:3,center:new google.maps.LatLng(0,0),mapTypeId:google.maps.MapTypeId.ROADMAP,boundsForLocation:this.updateBoundsForPlace},this.options.map),this.map=new google.maps.Map(e(this.mapOptions.id)[0],this.mapOptions)),this.lastResult=null,t=e.extend({draggable:!0,visible:!1,position:this.map.getCenter(),map:this.map},this.options.marker||{}),this.marker=new google.maps.Marker(t),t.draggable?google.maps.event.addListener(this.marker,"dragend",this.markerDragged):void 0},n.prototype.get=function(t,o){var r;return r=new google.maps.places.AutocompleteService,this.options.autocompleteService.input=t,r.getPlacePredictions(this.options.autocompleteService,function(t){return function(r){return e(t).trigger("addresspicker:predictions",[r]),o(r)}}(this))},n.prototype.updateMap=function(t,o){return this.placeService.getDetails(o,function(t){return function(o){var r;return t.lastResult=new AddressPickerResult(o),t.marker&&(t.marker.setPosition(o.geometry.location),t.marker.setVisible(!0)),t.map&&null!=(r=t.mapOptions)&&r.boundsForLocation(o),e(t).trigger("addresspicker:selected",t.lastResult)}}(this))},n.prototype.updateBoundsForPlace=function(t){return t.geometry.viewport?this.map.fitBounds(t.geometry.viewport):(this.map.setCenter(t.geometry.location),this.map.setZoom(this.options.zoomForLocation))},n.prototype.markerDragged=function(){return this.options.reverseGeocoding?this.reverseGeocode(this.marker.getPosition()):(this.lastResult?this.lastResult.setLatLng(this.marker.getPosition().lat(),this.marker.getPosition().lng()):this.lastResult=new AddressPickerResult({geometry:{location:this.marker.getPosition()}}),e(this).trigger("addresspicker:selected",this.lastResult))},n.prototype.reverseGeocode=function(t){return null==this.geocoder&&(this.geocoder=new google.maps.Geocoder),this.geocoder.geocode({location:t},function(t){return function(o){return o&&o.length>0?(t.lastResult=new AddressPickerResult(o[0],!0),e(t).trigger("addresspicker:selected",t.lastResult)):void 0}}(this))},n.prototype.getGMap=function(){return this.map},n.prototype.getGMarker=function(){return this.marker},n}(Bloodhound)}(jQuery)}).call(this);