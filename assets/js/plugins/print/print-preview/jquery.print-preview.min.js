!function(i){i.fn.printPreview=function(){return this.each(function(){i(this).bind("click",function(e){e.preventDefault(),i("#print-modal").length||i.printPreview.loadPrintPreview()})}),this};var e,n,t,o;i.printPreview={loadPrintPreview:function(){t=i('<div id="print-modal"></div>'),o=i('<div id="print-modal-controls"><a href="#" class="print" title="Print page">Print page</a><a href="#" class="close" title="Close print preview">Close</a>').hide();var e=i('<iframe id="print-modal-content" scrolling="no" border="0" frameborder="0" name="print-frame" />');t.hide().append(o).append(e).appendTo("body");for(var n=0;n<window.frames.length;n++)if("print-frame"==window.frames[n].name){var r=window.frames[n].document;break}r.open(),r.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><title>'+document.title+"</title></head><body></body></html>"),r.close();var a=i("head link[media*=print], head link[media=all]").clone(),d=i("body > *:not(#print-modal):not(script)").clone();a.each(function(){i(this).attr("media","all")}),i.browser.msie||i.browser.version<7?(i("body > *:not(#print-modal):not(script)").clone().each(function(){i("body",r).append(this.outerHTML)}),i("head link[media*=print], head link[media=all]").each(function(){i("head",r).append(i(this).clone().attr("media","all")[0].outerHTML)})):(i("head",r).append(a),i("body",r).append(d)),i("a",r).bind("click.printPreview",function(i){i.preventDefault()}),i("head").append('<style type="text/css">@media print {/* -- Print Preview --*/#print-modal-mask,#print-modal {display: none !important;}}</style>'),i.printPreview.loadMask(),i("body").css({overflowY:"hidden",height:"100%"}),i("img",r).load(function(){e.height(i("body",e.contents())[0].scrollHeight)}),starting_position=i(window).height()+i(window).scrollTop();var l={top:starting_position,height:"100%",overflowY:"auto",zIndex:1e4,display:"block"};t.css(l).animate({top:i(window).scrollTop()},400,"linear",function(){o.fadeIn("slow").focus()}),e.height(i("body",e.contents())[0].scrollHeight),i("a",o).bind("click",function(e){e.preventDefault(),i(this).hasClass("print")?window.print():i.printPreview.distroyPrintPreview()})},distroyPrintPreview:function(){o.fadeOut(100),t.animate({top:i(window).scrollTop()-i(window).height(),opacity:1},400,"linear",function(){t.remove(),i("body").css({overflowY:"auto",height:"auto"})}),e.fadeOut("slow",function(){e.remove()}),i(document).unbind("keydown.printPreview.mask"),e.unbind("click.printPreview.mask"),i(window).unbind("resize.printPreview.mask")},loadMask:function(){n=i.printPreview.sizeUpMask(),e=i('<div id="print-modal-mask" />').appendTo(i("body")),e.css({position:"absolute",top:0,left:0,width:n[0],height:n[1],display:"none",opacity:0,zIndex:9999,backgroundColor:"#000"}),e.css({display:"block"}).fadeTo("400",.75),i(window).bind("resize..printPreview.mask",function(){i.printPreview.updateMaskSize()}),e.bind("click.printPreview.mask",function(){i.printPreview.distroyPrintPreview()}),i(document).bind("keydown.printPreview.mask",function(e){27==e.keyCode&&i.printPreview.distroyPrintPreview()})},sizeUpMask:function(){if(i.browser.msie){var e=i(document).height(),n=i(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,20>e-n?n:e]}return[i(document).width(),i(document).height()]},updateMaskSize:function(){var n=i.printPreview.sizeUpMask();e.css({width:n[0],height:n[1]})}}}(jQuery);